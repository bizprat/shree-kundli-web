---
/**
 * Panchang Hub Page
 *
 * Landing page for daily panchang with:
 * - Today's quick panchang summary
 * - City selector for location-specific data
 * - Popular cities list
 */
import Layout from '../../layouts/Layout.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import CitySelector from '../../components/CitySelector.astro';
import type { BreadcrumbItem, City } from '../../lib/types';

// Load cities data
import citiesData from '../../data/cities-sample.json';
const cities = citiesData as City[];

// Group cities by tier
const tier1Cities = cities.filter(c => c.tier === 1);
const tier2Cities = cities.filter(c => c.tier === 2);

// Today's date
const today = new Date();
const todayFormatted = today.toLocaleDateString('en-IN', {
  weekday: 'long',
  day: 'numeric',
  month: 'long',
  year: 'numeric',
});
const todayIso = today.toISOString().split('T')[0];

// Page meta
const title = "Today's Panchang - Daily Hindu Calendar | Shree Kundli";
const description = `Check today's panchang (${todayFormatted}) with tithi, nakshatra, yoga, karana, sunrise, sunset, and rahu kaal for 500+ cities. Accurate Vedic panchang powered by Swiss Ephemeris.`;

// Breadcrumbs
const breadcrumbs: BreadcrumbItem[] = [
  { name: 'Home', url: '/' },
  { name: 'Panchang' },
];

// Schema
const panchangHubSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebPage',
  name: "Today's Panchang",
  alternateName: 'Aaj Ka Panchang',
  description: description,
  datePublished: todayIso,
  dateModified: todayIso,
  inLanguage: ['en-IN', 'hi-IN'],
  isPartOf: {
    '@type': 'WebSite',
    name: 'Shree Kundli',
  },
};
---

<Layout title={title} description={description} activeNav="panchang">
  <script is:inline type="application/ld+json" set:html={JSON.stringify(panchangHubSchema)} slot="head" />

  <div class="space-y-8">
    <!-- Breadcrumb -->
    <Breadcrumb items={breadcrumbs} />

    <!-- Header -->
    <header class="text-center space-y-4">
      <h1 class="font-heading text-3xl md:text-4xl text-primary font-bold">
        Today's Panchang
      </h1>
      <p class="text-lg text-neutral/70">
        <time datetime={todayIso}>{todayFormatted}</time>
      </p>
    </header>

    <!-- Quick Answer -->
    <section class="quick-answer" role="contentinfo">
      <div class="glass-shubh">
        <div class="p-4 md:p-6">
          <h2 class="font-heading text-xl text-primary font-semibold mb-2">
            What is Panchang?
          </h2>
          <p class="text-neutral/70">
            <dfn>Panchang</dfn> is the Hindu calendar system consisting of five elements:
            <strong>Tithi</strong> (lunar day), <strong>Nakshatra</strong> (constellation),
            <strong>Yoga</strong> (luni-solar combination), <strong>Karana</strong> (half of tithi),
            and <strong>Vara</strong> (weekday). It helps determine auspicious timings for ceremonies,
            festivals, and daily activities.
          </p>
        </div>
      </div>
    </section>

    <!-- City Selector -->
    <section>
      <h2 class="font-heading text-2xl text-primary font-bold mb-4">
        Select Your City
      </h2>
      <div class="max-w-md">
        <CitySelector
          cities={cities}
          baseUrl="/panchang"
          placeholder="Search for your city..."
        />
      </div>
      <p class="text-sm text-neutral/50 mt-2">
        Panchang calculations are location-specific. Select your city for accurate sunrise, sunset, and rahu kaal timings.
      </p>
    </section>

    <!-- Major Metro Cities -->
    <section>
      <h2 class="font-heading text-2xl text-primary font-bold mb-4">
        Major Cities
      </h2>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
        {tier1Cities.map((city) => (
          <a
            href={`/panchang/${city.slug}`}
            class="glass-card hover:border-secondary/30 transition-all"
          >
            <div class="p-3 text-center">
              <p class="font-semibold text-primary">{city.name}</p>
              <p class="text-xs text-neutral/40 mt-1">{city.state}</p>
            </div>
          </a>
        ))}
      </div>
    </section>

    <!-- Other Popular Cities -->
    <section>
      <h2 class="font-heading text-2xl text-primary font-bold mb-4">
        Other Popular Cities
      </h2>
      <div class="flex flex-wrap gap-2">
        {tier2Cities.slice(0, 20).map((city) => (
          <a
            href={`/panchang/${city.slug}`}
            class="btn btn-sm btn-ghost border border-base-200 min-h-9"
          >
            {city.name}
          </a>
        ))}
      </div>
      <p class="text-sm text-neutral/50 mt-4">
        Can't find your city? Use the search above to find panchang for any location in India.
      </p>
    </section>

    <!-- Panchang Elements -->
    <section>
      <h2 class="font-heading text-2xl text-primary font-bold mb-4">
        Five Elements of Panchang
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="glass-card">
          <div class="p-4">
            <h3 class="font-semibold text-primary">Tithi</h3>
            <p class="text-sm text-neutral/70">
              Lunar day based on moon's position relative to sun. 30 tithis in a lunar month.
            </p>
          </div>
        </div>
        <div class="glass-card">
          <div class="p-4">
            <h3 class="font-semibold text-primary">Nakshatra</h3>
            <p class="text-sm text-neutral/70">
              Constellation where moon is located. 27 nakshatras in the zodiac.
            </p>
          </div>
        </div>
        <div class="glass-card">
          <div class="p-4">
            <h3 class="font-semibold text-primary">Yoga</h3>
            <p class="text-sm text-neutral/70">
              Combination of sun and moon longitudes. 27 yogas with varying effects.
            </p>
          </div>
        </div>
        <div class="glass-card">
          <div class="p-4">
            <h3 class="font-semibold text-primary">Karana</h3>
            <p class="text-sm text-neutral/70">
              Half of a tithi. 11 karanas that repeat in a cycle.
            </p>
          </div>
        </div>
        <div class="glass-card">
          <div class="p-4">
            <h3 class="font-semibold text-primary">Vara</h3>
            <p class="text-sm text-neutral/70">
              Day of the week, each ruled by a planet. Important for muhurat.
            </p>
          </div>
        </div>
        <div class="glass-card">
          <div class="p-4">
            <h3 class="font-semibold text-primary">Rahu Kaal</h3>
            <p class="text-sm text-neutral/70">
              Inauspicious period each day. Avoid starting new work during this time.
            </p>
          </div>
        </div>
      </div>
    </section>
  </div>
</Layout>
