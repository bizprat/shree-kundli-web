---
/**
 * ContextBar Component
 *
 * Sticky navigation bar showing city, date, and tab navigation.
 * Used on daily pages (panchang, rahu-kaal, choghadiya).
 *
 * Usage:
 * <ContextBar
 *   city="Delhi"
 *   citySlug="delhi"
 *   date="February 4, 2026"
 *   activeTab="panchang"
 * />
 */

interface Props {
  /** City name */
  city: string;
  /** City URL slug */
  citySlug: string;
  /** Formatted date string */
  date: string;
  /** Currently active tab */
  activeTab: 'panchang' | 'rahu-kaal' | 'choghadiya';
  /** Additional CSS classes */
  class?: string;
  /** Language for tab labels */
  lang?: 'en' | 'hi';
}

const {
  city,
  citySlug,
  date,
  activeTab,
  class: className = '',
  lang = 'en',
} = Astro.props;

const tabs = [
  {
    id: 'panchang',
    label: lang === 'hi' ? '‡§™‡§Ç‡§ö‡§æ‡§Ç‡§ó' : 'Panchang',
    href: `/panchang/${citySlug}`,
    icon: 'üìÖ',
  },
  {
    id: 'rahu-kaal',
    label: lang === 'hi' ? '‡§∞‡§æ‡§π‡•Å ‡§ï‡§æ‡§≤' : 'Rahu Kaal',
    href: `/rahu-kaal/${citySlug}`,
    icon: '‚ö†Ô∏è',
  },
  {
    id: 'choghadiya',
    label: lang === 'hi' ? '‡§ö‡•å‡§ò‡§°‡§º‡§ø‡§Ø‡§æ' : 'Choghadiya',
    href: `/choghadiya/${citySlug}`,
    icon: '‚è±Ô∏è',
  },
];
---

<div
  class:list={[
    'sticky top-14 z-30 glass-card border-b border-base-300',
    '-mx-4 px-4 py-3 mb-6',
    'md:-mx-6 md:px-6',
    className,
  ]}
>
  <!-- City + Date Row -->
  <div class="flex items-center justify-between mb-3">
    <!-- City Selector Trigger -->
    <button
      class="flex items-center gap-2 text-sm hover:text-primary transition-colors touch-target"
      aria-label="Change city"
      data-city-selector
    >
      <span aria-hidden="true">üìç</span>
      <span class="font-medium max-w-[150px] truncate">{city}</span>
      <span class="text-neutral" aria-hidden="true">‚ñæ</span>
    </button>

    <!-- Date Display -->
    <div class="flex items-center gap-2 text-sm text-neutral">
      <span aria-hidden="true">üìÖ</span>
      <time>{date}</time>
    </div>
  </div>

  <!-- Tab Navigation -->
  <nav class="flex gap-1" aria-label="Page type navigation">
    {tabs.map((tab) => (
      <a
        href={tab.href}
        class:list={[
          'flex-1 text-center py-2.5 rounded-lg text-sm font-medium transition-all',
          'touch-target flex items-center justify-center gap-1',
          activeTab === tab.id
            ? 'bg-primary text-primary-content shadow-lg shadow-primary/20'
            : 'text-neutral hover:text-base-content hover:bg-base-300/50',
        ]}
        aria-current={activeTab === tab.id ? 'page' : undefined}
      >
        <span class="hidden sm:inline" aria-hidden="true">{tab.icon}</span>
        <span>{tab.label}</span>
      </a>
    ))}
  </nav>
</div>
